function t(t){return t&&t.__esModule?t.default:t}var e=globalThis,s={},r={},n=e.parcelRequire09fa;null==n&&((n=function(t){if(t in s)return s[t].exports;if(t in r){var e=r[t];delete r[t];var n={id:t,exports:{}};return s[t]=n,e.call(n.exports,n,n.exports),n.exports}var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){r[t]=e},e.parcelRequire09fa=n),(0,n.register)("27Lyk",function(t,e){Object.defineProperty(t.exports,"register",{get:()=>s,set:t=>s=t,enumerable:!0,configurable:!0});var s,r=new Map;s=function(t,e){for(var s=0;s<e.length-1;s+=2)r.set(e[s],{baseUrl:t,path:e[s+1]})}}),n("27Lyk").register(new URL("",import.meta.url).toString(),JSON.parse('["dBDXI","homePage.4d140030.js","6hMtG","edit.ae2dc990.svg","funvN","close.03f4cb75.svg","3FadK","ellipse.57372ae0.svg","8mLDM","plus.ddb5af5f.svg","3AVgl","check.5b6afd3d.svg"]'));var a={};a=new URL("edit.ae2dc990.svg",import.meta.url).toString();var i={};i=new URL("close.03f4cb75.svg",import.meta.url).toString();var c={};c=new URL("ellipse.57372ae0.svg",import.meta.url).toString();var o={};o=new URL("plus.ddb5af5f.svg",import.meta.url).toString();class u{constructor(){this.instance=this}static getInstance(){return u.instance||(u.instance=new u),u.instance}static renderProductCard({id:e,name:s,imageURL:r,price:n,quantity:o}){return`
            <div class="product" data-id="${e}">
              <img class="icon product__icon js-get-warning" src="${t(i)}" id="${e}"/>
              <img
                class="product__img js-get-imageURL"
                src="${r}"
                alt="${s}"
              />
              <div class="product__description">
                <h4 class="item js-get-name">${s}</h4>
                <p class="item item--thin">
                  $ 
                  <span class="js-get-price">${n}</span>
                  <img class="icon" src="${t(c)}" />
                  <span class="js-get-quantity">${o}</span>
                  Bowls
                </p>
              </div>
              <button class="product__btn js-edit-product">
                <img class="icon" src="${t(a)}" />
                Edit dish
              </button>
            </div>`}static renderAdditionCard(){return`            
            <div class="product product--dashed js-add-product">
              <img
                class="icon icon--padded"
                src="${t(o)}"
                alt="add food"
              />
              <span class="highlight">Add new dish</span>
            </div>`}}class d{constructor(){this.BASE_URL="https://669e22209a1bda368005842c.mockapi.io/api/v1/",this.PRODUCTS_ENDPOINT="products",this.instance=this}static getInstance(){return d.instance||(d.instance=new d),d.instance}}class l{constructor(){this.instance=this,this.ADD_PRODUCT_SUCCESS="Add product successfully",this.ADD_PRODUCT_FAILED="Failed to add product",this.DELETE_PRODUCT_SUCCESS="Delete product successfully",this.DELETE_PRODUCT_FAILED="Failed to delete the product",this.EDIT_PRODUCT_SUCCESS="Update product successfully",this.EDIT_PRODUCT_FAILED="Failed to update the product",this.GET_PRODUCT_FAILED="Failed to load products",this.NOT_FOUND="No Results Found",this.ERROR_NETWORK="Error network"}static getInstance(){return l.instance||(l.instance=new l),l.instance}}var h={};h=new URL("check.5b6afd3d.svg",import.meta.url).toString();class p{constructor(){this.instance=this}static getInstance(){return p.instance||(p.instance=new p),p.instance}renderNotification({status:e="",message:s=""}){if(s){let r=document.querySelector(".js-message"),n=document.querySelector(".js-message-content"),a=r.querySelector(".message__icon");"ok"===e?(r.classList.add("message--success"),r.classList.remove("message--error"),a.src=t(h),a.alt="success"):"error"===e&&(r.classList.add("message--error"),r.classList.remove("message--success"),a.src=t(i),a.alt="error"),n.textContent=s,r.classList.add("show"),setTimeout(()=>{r.classList.remove("show")},2e3)}}}class m{constructor(){this.api=d.getInstance(),this.url=`${this.api.BASE_URL}${this.api.PRODUCTS_ENDPOINT}`,this.notificationInstance=p.getInstance(),this.instance=this}static getInstance(){return m.instance||(m.instance=new m),m.instance}async getProduct(t=9){try{let e=new URL(this.url);e.searchParams.append("page",1),e.searchParams.append("limit",t);let s=await fetch(e);if(!s.ok)return this.notificationInstance.renderNotification({status:"error",message:l.getInstance().NOT_FOUND}),null;return s.json()}catch(t){this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ERROR_NETWORK})}}async filterProduct(t="",e="",s=9){try{let r=new URL(this.url);r.searchParams.append("page",1),r.searchParams.append("limit",s),""!==t&&""!==e&&r.searchParams.append(t,e);let n=await fetch(r);if(!n.ok)return this.notificationInstance.renderNotification({status:"error",message:l.getInstance().NOT_FOUND}),null;return n.json()}catch(t){this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ERROR_NETWORK})}}async getProductById(t){try{let e=await fetch(`${this.url}/${t}`);if(!e.ok)return this.notificationInstance.renderNotification({status:"error",message:l.getInstance().NOT_FOUND}),null;return e.json()}catch(t){this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ERROR_NETWORK})}}async addProduct(t){try{let e=await fetch(this.url,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(!e.ok)return this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ADD_PRODUCT_FAILED}),null;return e.json()}catch(t){this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ERROR_NETWORK})}}async editProduct(t){try{let e=await fetch(`${this.url}/${t.id}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(!e.ok)return this.notificationInstance.renderNotification({status:"error",message:l.getInstance().EDIT_PRODUCT_FAILED}),null;return e.json()}catch(t){this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ERROR_NETWORK})}}async deleteProduct(t){try{let e=await fetch(`${this.url}/${t}`,{method:"DELETE"});if(!e.ok)return this.notificationInstance.renderErrorNotification(l.getInstance().DELETE_PRODUCT_FAILED),null;return e.json()}catch(t){this.notificationInstance.renderNotification({status:"error",message:l.getInstance().ERROR_NETWORK})}}}class g{constructor(){this.instance=this}static getInstance(){return g.instance||(g.instance=new g),g.instance}static sortObjectsByPropertyAZ(t,e){return t.sort((t,s)=>t[e]>s[e]?1:t[e]<s[e]?-1:0)}}class f{constructor(){this.instance=this}static getInstance(){return f.instance||(f.instance=new f),f.instance}showLoader(){let t=document.querySelector(".js-wrapper-popup"),e=document.createElement("div");t.innerHTML="",e.classList.add("loader"),t.appendChild(e),t.classList.add("show")}hideLoader(){let t=document.querySelector(".js-wrapper-popup");t.classList.remove("show"),t.innerHTML=""}}class y{constructor(){this.instance=this,this.loaderInstance=f.getInstance(),this.productTemplate=u.getInstance(),this.productService=m.getInstance(),this.notificationInstance=p.getInstance(),this.products=[],this.limit=9}static getInstance(){return y.instance||(y.instance=new y),y.instance}async getProduct(){return!this.products.length&&(this.products=await this.productService.getProduct(this.limit),Array.isArray(this.products)&&this.products.length>0&&(this.products=this.products.reverse())),this.products}async filterProduct({typeOfSort:t="",property:e="",value:s="",limit:r=9}){this.loaderInstance.showLoader(),this.limit=r;let n=document.querySelector(".js-get-products");n.innerHTML="";let a=u.renderAdditionCard();this.products=await this.productService.filterProduct(e,s,r),Array.isArray(this.products)&&this.products.length>0&&(this.products=this.products.reverse(),"AToZ"===t&&(this.products=g.sortObjectsByPropertyAZ(this.products,"name")),"ZToA"===t&&(this.products=g.sortObjectsByPropertyAZ(this.products,"name").reverse()),this.products.forEach(t=>{a+=u.renderProductCard(t)})),n.innerHTML+=a,this.loaderInstance.hideLoader()}async getProductById(t){return await this.productService.getProductById(t)}async submitProduct(t){let e;if(t.id&&(e=await this.productService.editProduct(t))){this.notificationInstance.renderNotification({status:"ok",message:l.getInstance().EDIT_PRODUCT_SUCCESS});let s=this.products.findIndex(e=>e.id===t.id);return -1!==s&&(this.products[s]=t),{success:!0,data:e}}return(e=await this.productService.addProduct(t))?(this.notificationInstance.renderNotification({status:"ok",message:l.getInstance().ADD_PRODUCT_SUCCESS}),this.products.unshift(e),{success:!0,data:e}):{success:!1,data:e}}async deleteProduct(t){let e=await this.productService.deleteProduct(t);return e?(this.notificationInstance.renderNotification({status:"ok",message:l.getInstance().DELETE_PRODUCT_SUCCESS}),this.products=this.products.filter(e=>e.id!==t),{success:!0,data:e}):{success:!1,data:e}}}class v{constructor(){this.instance=this,this.typeOfSort="",this.property="name",this.value="",this.limit=9}static getInstance(){return v.instance||(v.instance=new v),v.instance}setFilter({typeOfSort:t,value:e,limit:s}){this.typeOfSort=t||this.typeOfSort,this.value=e,this.limit=s||this.limit}}class I{constructor(){this.instance=this}static getInstance(){return I.instance||(I.instance=new I),I.instance}static renderWarning(t){return`          
          <div class="popup">
            <h2 class="popup__content">
              Are you sure you want to delete this food?
            </h2>
            <div class="popup__action">
              <button class="btn btn--line js-hidden-form">Cancel</button>
              <button class="btn btn--fill js-accept" id="${t}">Yes</button>
            </div>
          </div>`}static renderProductForm({id:t="",name:e="",imageURL:s="",price:r="",quantity:n=""}){return`
        <form action="" class="form form--center" id="js-product-form">
          <input type="hidden" name="id" value="${t}" />
          <h2 class="form__title">${""!==t?"Edit":"Create a new food"}</h2>
          <label for="name" class="form__label">Name</label>
          <input
            type="text"
            id="name"
            name="name"
            class="text-field"
            value="${e}"
          />
          <span class="form__error js-name-error"></span>
          <label for="price" class="form__label">Price</label>
          <input
            type="text"
            id="price"
            name="price"
            class="text-field js-check-number"
            value="${r}"
          />
          <span class="form__error js-price-error"></span>
          <label for="imageURL" class="form__label">Image URL</label>
          <input
            type="text"
            id="imageURL"
            name="imageURL"
            class="text-field js-check-imageURL"
            value="${s}"
          />
          <span class="form__error js-imageURL-error"></span>
          <label for="quantity" class="form__label">Quantity</label>
          <input
            type="text"
            id="quantity"
            name="quantity"
            class="text-field text-field--short js-check-number"
            value="${n}"
          />
          <span class="form__error js-quantity-error"></span>
          <div class="form__action">
            <input class="btn btn--line js-hidden-form" value="Cancel" />
            <input type="submit" class="btn btn--fill" value="Save" />
          </div>
        </form>`}}class _{constructor(){this.instance=this,this.maxLen=100,this.minLen=2,this.specialChars=/[!@#$%^&*()+\-=[\]{};':"\\|,.<>/?]/,this.alphanumeric=/^[a-zA-Z0-9\s]*$/,this.imageExtensions=["jpg","jpeg","png","gif","bmp"],this.realNumber=/^[0-9]*\.?[0-9]*$/}static getInstance(){return _.instance||(_.instance=new _),_.instance}}class L{constructor(){this.instance=this}static getInstance(){return L.instance||(L.instance=new L),L.instance}static isNotEmpty(t,e){return e.trim().length?void 0:`${t} is required.`}static checkLenOfString(t,e){return e.trim().length<2||e.trim().length>100?`${t} must have between ${_.getInstance().minLen} and ${_.getInstance().maxLen} characters`:void 0}static isFloat(t,e){return _.getInstance().realNumber.test(e)&&(e.match(/\./g)||[]).length<=1?void 0:`${t} must be a real number`}static isInteger(t,e){return Number.isInteger(Number(e))?void 0:`${t} must be an integer number`}static isWithSpecialChars(t,e){return _.getInstance().specialChars.test(e)?void 0:`${t} must contain at least one special character (!@#$%^&*(),.?":{}|<>)`}static isValidString(t,e){return _.getInstance().alphanumeric.test(e)?void 0:`${t} contains invalid characters. Only alphanumeric characters and spaces are allowed`}static async isValidImageUrl(t,e){if(!e.startsWith("http://")&&!e.startsWith("https://"))return`${t} must start with http:// or https://`;try{let s=await fetch(e,{method:"HEAD"});if(!s.ok)return`${t} does not point to a valid image resource`;let r=s.headers.get("Content-Type"),n=_.getInstance().imageExtensions;if(!n.some(t=>r.includes(t)))return`${t} does not point to a valid image resource. Allowed types are: ${n.join(", ")}`;return}catch(e){return`${t} does not point to a valid image resource`}}static checkName(t,e){return L.isNotEmpty(t,e)||L.checkLenOfString(t,e)||L.isValidString(t,e)||!1}static checkQuantity(t,e){return L.isNotEmpty(t,e)||L.isInteger(t,e)||!1}static checkPrice(t,e){return L.isNotEmpty(t,e)||L.isFloat(t,e)||!1}static async checkImageURL(t,e){return L.isNotEmpty(t,e)||await L.isValidImageUrl(t,e)||!1}}class w{constructor(){return w.instance||(this.events={},w.instance=this),w.instance}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}emit(t,e){this.events[t]&&this.events[t].forEach(t=>t(e))}}var E=new w;class S{constructor(t){this.instance=this,this.currentProduct=t,this.loaderInstance=f.getInstance(),this.validationImageResult=void 0}static getInstance(t={}){return S.instance?S.instance.currentProduct=t:S.instance=new S(t),S.instance}showForm(){let t=document.querySelector(".js-wrapper-popup"),e=I.renderProductForm(this.currentProduct);t.innerHTML=e,t.classList.add("show"),this.hideForm(),this.submitForm(),this.validationImage(),this.pressOnlyNumber()}hideForm(){let t=document.querySelector(".js-hidden-form"),e=document.querySelector(".js-wrapper-popup");t.addEventListener("click",t=>{t.preventDefault(),e.classList.remove("show"),e.innerHTML=""})}submitForm(){let t=document.getElementById("js-product-form"),e=y.getInstance(),s={};t.addEventListener("submit",async r=>{if(r.preventDefault(),Array.from(t.elements).forEach(t=>{t&&"Save"!==t.value&&"Cancel"!==t.value&&(s[t.name]=t.value)}),this.validationForm(s)&&!this.validationImageResult){document.querySelector(".js-wrapper-popup").classList.remove("show"),this.loaderInstance.showLoader();let t=await e.submitProduct(s);this.validationImageResult=!1,t.success&&E.emit("reloadProduct"),this.loaderInstance.hideLoader()}})}pressOnlyNumber(){document.querySelectorAll(".js-check-number").forEach(t=>{t.addEventListener("keypress",e=>{let{charCode:s}=e,r=t.value;if(46===s&&0===t.selectionStart||r.includes(".")&&46===s){e.preventDefault();return}(s<48||s>57)&&46!==s&&e.preventDefault()})})}async validationImage(){document.querySelector(".js-check-imageURL").addEventListener("change",async t=>{let e=t.target.value,s=await L.checkImageURL("imageURL",e),r=document.querySelector(".js-imageURL-error");if(s){r.textContent=s,r.classList.add("show"),this.validationImageResult=s;return}r.textContent="",r.classList.remove("show"),this.validationImageResult=!1})}validationForm(t){let e=!0,s={"name-error":L.checkName("name",t.name),"price-error":L.checkPrice("price",t.price),"quantity-error":L.checkQuantity("quantity",t.quantity),"imageURL-error":L.isNotEmpty("imageURL",t.imageURL)||this.validationImageResult||!1};return Object.keys(s).forEach(t=>{let r=document.querySelector(`.js-${t}`);if(s[t]){r.classList.add("show"),r.innerHTML=s[t],e=!1;return}r.classList.remove("show")}),e}showWarningForm(t,e){let s=document.querySelector(".js-wrapper-popup");s.innerHTML=I.renderWarning(t),s.classList.add("show"),document.querySelector(".popup").style.marginTop=`${e}px`,this.hideForm(),this.acceptWarningForm()}acceptWarningForm(){let t=document.querySelector(".js-accept"),e=y.getInstance();t.addEventListener("click",async t=>{document.querySelector(".js-wrapper-popup").classList.remove("show"),this.loaderInstance.showLoader(),(await e.deleteProduct(t.target.id)).success&&E.emit("reloadProduct"),this.loaderInstance.hideLoader()})}}class R{constructor(){this.instance=this,this.popupInstance=S.getInstance(),this.loaderInstance=f.getInstance(),this.productInstance=y.getInstance()}static getInstance(){return R.instance||(R.instance=new R),R.instance}async create(){this.loaderInstance.showLoader(),await this.renderProduct(),this.showPopup(),this.dropdownToggle(),this.filterProduct(),this.getMoreProduct(),E.on("reloadProduct",()=>{this.renderProduct()}),this.loaderInstance.hideLoader()}dropdownToggle(){let t=document.querySelector(".js-btn-toggle"),e=document.querySelector(".js-sort-option");t.addEventListener("click",()=>{e.classList.toggle("show")})}async renderProduct(t=9){let e=await this.productInstance.getProduct(t),s=document.querySelector(".js-get-products");s.innerHTML="";let r=u.renderAdditionCard();Array.isArray(e)&&e.length>0&&e.forEach(t=>{r+=u.renderProductCard(t)}),s.innerHTML+=r}filterProduct(){let t=document.querySelector(".js-filter-input"),e=document.querySelectorAll(".sort-option__item"),s=document.querySelector(".js-sort-option"),r=y.getInstance(),n=v.getInstance();t.addEventListener("change",async t=>{n.setFilter({value:t.target.value}),await r.filterProduct(n)}),e.forEach(e=>{e.addEventListener("click",async e=>{s.classList.remove("show");let a=e.target.getAttribute("data-value");n.setFilter({typeOfSort:a,value:t.value}),await r.filterProduct(n)})})}showPopup(){document.querySelector(".js-get-popup").addEventListener("click",t=>{let e=t.target;if(e.closest(".js-edit-product")){let t=e.closest(".product"),s=t.getAttribute("data-id"),r=t.querySelector(".js-get-name").textContent.trim();new S({id:s,name:r,imageURL:t.querySelector(".js-get-imageURL").src.trim(),price:t.querySelector(".js-get-price").textContent.trim(),quantity:t.querySelector(".js-get-quantity").textContent.trim()}).showForm();return}if(e.closest(".js-get-warning")){let s=e.closest(".product").getAttribute("data-id"),r=t.target.getBoundingClientRect().top+window.scrollY;this.popupInstance.showWarningForm(s,r);return}e.closest(".js-add-product")&&this.popupInstance.showForm()})}getMoreProduct(){let t=document.querySelector(".js-show-more-product"),e=document.querySelector(".js-filter-input"),s=y.getInstance(),r=v.getInstance();t.addEventListener("click",async t=>{let n=t.target.getAttribute("data-value");t.target.setAttribute("data-value",Number(n)+10),r.setFilter({value:e.value,limit:n}),await s.filterProduct(r)})}}class P{constructor(){this.instance=this,this.homePage=R.getInstance()}async init(){await this.homePage.create()}static getInstance(){return P.instance||(P.instance=new P),P.instance}}P.getInstance().init();
//# sourceMappingURL=homePage.4d140030.js.map
